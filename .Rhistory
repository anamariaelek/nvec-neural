vrtb <- "Axolotl|bat|Bonobo|Branchiostoma|Chimpanzee|Chicken|Cow|Dog|Frog|Hamster|horse|lemur|Lizard|macaque|Rhesus|Marmoset|monkey|Pig|Rabbit|Stickleback|mole|cobra|snake|Salmon|Sheep|HamsterTurtle|Xenopus|Pogona vitticeps"
scs[grep(vrtb, Organism, ignore.case = TRUE), Organism := "vertebrate"]
sdt <- scs[,.N,Organism][order(N)]
dt <- sdt[,.(N=sum(N)),Organism][Organism!=""][order(-N)]
dta <- rbind.data.frame(dt[N>=10], data.table(Organism="other",N=sum(dt[N<10]$N)))
dta[,data:="scRNA"]
dta[,Organism:=factor(Organism,levels=c(setdiff(dta$Organism, c("vertebrate", "other")), "vertebrate", "other"))]
setorder(dta, Organism)
color_palette = colorRampPalette(c("magenta4","firebrick1","orange","khaki1","springgreen2","darkgreen","deepskyblue","cadetblue1","mediumblue","darkviolet","violet"))
color_blind  = colorRampPalette(c("#999999", "#CC79A7", "#D55E00", "#E69F00", "#F0E442","#009E73", "#56B4E9", "#0072B2"))
orgcol <- structure(rev(color_blind(nlevels(dta$Organism))), names=levels(dta$Organism))
gb1 <- ggplot(dta,aes(data,N,fill=Organism, label=Organism)) + geom_bar(stat="identity") +
ggrepel::geom_label_repel(size=3, position=position_stack(vjust=0.5)) +
ggpubr::theme_pubclean() + scale_fill_manual(values=orgcol) +
theme(legend.position="none", axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(x="", y="datasets")
ggsave("scRNA-datasets.pdf",gb1,height=6.5,width=2)
sct <- scs[,.(Date,Organism,`Reported cells total`)]
scts <- as.data.table(tidyr::separate_rows(sct, "Organism", sep=", "))
scts <- scts[,Organism:=stringr::str_replace_all(Organism,c("Arabidopsis thaliana"="Arabidopsis"))][Organism!=""]
scts[!Organism%in%dta$Organism,Organism:="other"]
scts[,Organism:=factor(Organism,levels=dta$Organism)]
scts[,total_cells:=as.integer(stringr::str_remove_all(`Reported cells total`,","))]
scts[,Date:=as.Date.character(Date,format="%Y%m%d")]
#setnames(scts,"Reported cells total", "total_cells")
gp1 <- ggplot(scts,aes(Date, total_cells, color=Organism)) + geom_point() +
scale_y_log10(
breaks = scales::trans_breaks("log10", function(x) 10^x),
labels = scales::trans_format("log10", scales::math_format(10^.x))) +
scale_x_date(limits = c(as.Date.character("20120101",format="%Y%m%d"),NA)) +
ggpubr::theme_pubclean() + scale_color_manual(values = orgcol) +
theme(legend.position = "none") +
labs(y="Total reported cells per dataset",x="Year")
ggsave("scRNA-timeline-full.pdf",gp1,height=5,width=4.5)
dtb <- scts[,.(N=sum(total_cells,na.rm = TRUE)),Organism][,data:="cells"]
gb2 <- ggplot(dtb,aes(data,N,fill=Organism, label=Organism)) +
geom_bar(stat="identity") +
#ggrepel::geom_label_repel(size=3, position=position_stack(vjust=0.5)) +
ggpubr::theme_pubclean() +
scale_fill_manual(values=orgcol) +
theme(legend.position="none", axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(x="", y="cells")
ggsave("scRNA-cells.pdf",gb1 + gb2, height=6.5, width=4)
gb1 <- ggplot(dta,aes(data,N,fill=Organism, label=Organism)) + geom_bar(stat="identity") +
#ggrepel::geom_label_repel(size=3, position=position_stack(vjust=0.5)) +
ggpubr::theme_pubclean() + scale_fill_manual(values=orgcol) +
theme(legend.position="bottom", axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(x="", y="datasets")
ggsave("scRNA-datasets.pdf",gb1,height=6.5,width=2)
ggsave("scRNA-cells.pdf",gb1 + gb2, height=6.5, width=4)
gb1 <- ggplot(dta,aes(data,N,fill=Organism, label=Organism)) + geom_bar(stat="identity") +
#ggrepel::geom_label_repel(size=3, position=position_stack(vjust=0.5)) +
ggpubr::theme_pubclean() + scale_fill_manual(values=orgcol) +
theme(legend.position="left", axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(x="", y="datasets")
ggsave("scRNA-datasets.pdf",gb1,height=6.5,width=2)
ggsave("scRNA-cells.pdf",gb1 + gb2, height=6.5, width=4)
ggsave("scRNA-cells.pdf",gb1 + gb2, height=6.5, width=6)
library(data.table)
library(ggplot2)
library(patchwork)
setwd("~/cluster/aelek/presentations/BCA230515/")
# scs <- fread("https://www.nxn.se/single-cell-studies/data.tsv")
# fwrite(scs,"single-cell-studies.tsv",sep="\t",col.names=TRUE)
scs <- fread("single-cell-studies.tsv")
scs <- as.data.table(tidyr::separate_rows(scs, "Organism", sep=", "))
scs <- scs[Organism != ""]
scs[, Organism:=stringr::str_replace_all(
Organism,
c(
"Arabidopsis thaliana" = "Arabidopsis",
"Caenorhabditis elegans"= "C.elegans",
"C elegans"= "C.elegans",
"Fruit fly" = "Drosophila"
)
)]
vrtb <- "Axolotl|bat|Bonobo|Branchiostoma|Chimpanzee|Chicken|Cow|Dog|Frog|Hamster|horse|lemur|Lizard|macaque|Rhesus|Marmoset|monkey|Pig|Rabbit|Stickleback|mole|cobra|snake|Salmon|Sheep|HamsterTurtle|Xenopus|Pogona vitticeps"
scs[grep(vrtb, Organism, ignore.case = TRUE), Organism := "vertebrate"]
sdt <- scs[,.N,Organism][order(N)]
dt <- sdt[,.(N=sum(N)),Organism][Organism!=""][order(-N)]
dta <- rbind.data.frame(dt[N>=10], data.table(Organism="other",N=sum(dt[N<10]$N)))
dta[,data:="scRNA"]
dta[,Organism:=factor(Organism,levels=c(setdiff(dta$Organism, c("vertebrate", "Arabidopsis", "other")), "vertebrate", "Arabidopsis", "other"))]
setorder(dta, Organism)
color_palette = colorRampPalette(c("magenta4","firebrick1","orange","khaki1","springgreen2","darkgreen","deepskyblue","cadetblue1","mediumblue","darkviolet","violet"))
color_blind  = colorRampPalette(c("#999999", "#CC79A7", "#D55E00", "#E69F00", "#F0E442","#009E73", "#56B4E9", "#0072B2"))
orgcol <- structure(rev(color_blind(nlevels(dta$Organism))), names=levels(dta$Organism))
gb1 <- ggplot(dta,aes(data,N,fill=Organism, label=Organism)) + geom_bar(stat="identity") +
#ggrepel::geom_label_repel(size=3, position=position_stack(vjust=0.5)) +
ggpubr::theme_pubclean() + scale_fill_manual(values=orgcol) +
theme(legend.position="left", axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(x="", y="datasets")
ggsave("scRNA-datasets.pdf",gb1,height=6.5,width=2)
sct <- scs[,.(Date,Organism,`Reported cells total`)]
scts <- as.data.table(tidyr::separate_rows(sct, "Organism", sep=", "))
scts[!Organism%in%dta$Organism,Organism:="other"]
scts[,Organism:=factor(Organism,levels=dta$Organism)]
scts[,total_cells:=as.integer(stringr::str_remove_all(`Reported cells total`,","))]
scts[,Date:=as.Date.character(Date,format="%Y%m%d")]
#setnames(scts,"Reported cells total", "total_cells")
gp1 <- ggplot(scts,aes(Date, total_cells, color=Organism)) + geom_point() +
scale_y_log10(
breaks = scales::trans_breaks("log10", function(x) 10^x),
labels = scales::trans_format("log10", scales::math_format(10^.x))) +
scale_x_date(limits = c(as.Date.character("20120101",format="%Y%m%d"),NA)) +
ggpubr::theme_pubclean() + scale_color_manual(values = orgcol) +
theme(legend.position = "none") +
labs(y="Total reported cells per dataset",x="Year")
ggsave("scRNA-timeline-full.pdf",gp1,height=5,width=4.5)
dtb <- scts[,.(N=sum(total_cells,na.rm = TRUE)),Organism][,data:="cells"]
gb2 <- ggplot(dtb,aes(data,N,fill=Organism, label=Organism)) +
geom_bar(stat="identity") +
#ggrepel::geom_label_repel(size=3, position=position_stack(vjust=0.5)) +
ggpubr::theme_pubclean() +
scale_fill_manual(values=orgcol) +
theme(legend.position="none", axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(x="", y="cells")
ggsave("scRNA-cells.pdf",gb1 + gb2, height=6.5, width=6)
dt
dtb
scts
sct <- scs[,.(Date,Organism,`Reported cells total`)]
sct
scts <- as.data.table(tidyr::separate_rows(sct, "Organism", sep=", "))
scts[]
scts[,.N,Organism]
scts[!Organism %in% dta$Organism, Organism := "other"]
scts[,Organism:=factor(Organism,levels=dta$Organism)]
scts[,total_cells:=as.integer(stringr::str_remove_all(`Reported cells total`,","))]
scts
scts[,Date:=as.Date.character(Date,format="%Y%m%d")]
scts[ `Reported cells total:= NULL]
scts
scts[ `Reported cells total`:= NULL]
scts[,`Reported cells total`:= NULL]
scts
scts <- as.data.table(tidyr::separate_rows(sct, "Organism", sep=", "))
scts[!Organism %in% dta$Organism, Organism := "other"]
scts[,Organism:=factor(Organism,levels=dta$Organism)]
scts[,total_cells:=as.integer(stringr::str_remove_all(`Reported cells total`,","))]
scts[,Date:=as.Date.character(Date,format="%Y%m%d")]
scts
scts[,`Reported cells total`:= NULL]
scts
scts <- scts[is.na(total_cells)]
scts
scts <- as.data.table(tidyr::separate_rows(sct, "Organism", sep=", "))
scts[!Organism %in% dta$Organism, Organism := "other"]
scts[,Organism:=factor(Organism,levels=dta$Organism)]
scts[,total_cells:=as.integer(stringr::str_remove_all(`Reported cells total`,","))]
scts[,Date:=as.Date.character(Date,format="%Y%m%d")]
scts[,`Reported cells total`:= NULL]
scts <- scts[!is.na(total_cells)]
scts
scts[,sum(total_cells),Organism]
scts[,Organism:=factor(Organism,levels=c(setdiff(dta$Organism, c("vertebrate", "Arabidopsis", "other")), "vertebrate", "Arabidopsis", "other"))]
scts[,sum(total_cells),Organism]
setorder(scts, Organism)
scts
scts[,sum(total_cells),Organism]
sct <- scs[,.(Date,Organism,`Reported cells total`)]
scts <- as.data.table(tidyr::separate_rows(sct, "Organism", sep=", "))
scts[,total_cells:=as.integer(stringr::str_remove_all(`Reported cells total`,","))]
scts[,Date:=as.Date.character(Date,format="%Y%m%d")]
scts[,`Reported cells total`:= NULL]
scts <- scts[!is.na(total_cells)]
scts
scts[, organism_cells := sum(total_cells), Organism]
scts
scts[order(-organism_cells)]
unique(scts[Organism, organism_cells])[order(-organism_cells)]
unique(scts[ ,.(Organism, organism_cells)])[order(-organism_cells)]
sdt <- unique(scts[ ,.(Organism, organism_cells)])[order(-organism_cells)]
orgcells <- unique(scts[ ,.(Organism, organism_cells)])[order(-organism_cells)]
scts[!Organism %in% dta$Organism, Organism := "other"]
scts[,Organism:=factor(Organism,levels=dta$Organism)]
setorder(scts, Organism)
scts
scts[,organism_cells := sum(total_cells),Organism]
scts
gp1 <- ggplot(scts,aes(Date, total_cells, color=Organism)) + geom_point() +
scale_y_log10(
breaks = scales::trans_breaks("log10", function(x) 10^x),
labels = scales::trans_format("log10", scales::math_format(10^.x))) +
scale_x_date(limits = c(as.Date.character("20120101",format="%Y%m%d"),NA)) +
ggpubr::theme_pubclean() + scale_color_manual(values = orgcol) +
theme(legend.position = "none") +
labs(y="Total reported cells per dataset",x="Year")
ggsave("scRNA-timeline-full.pdf",gp1,height=5,width=4.5)
dtb <- scts[,.(N=sum(total_cells,na.rm = TRUE)),Organism][,data:="cells"]
gb2 <- ggplot(dtb,aes(data,N,fill=Organism, label=Organism)) +
geom_bar(stat="identity") +
#ggrepel::geom_label_repel(size=3, position=position_stack(vjust=0.5)) +
ggpubr::theme_pubclean() +
scale_fill_manual(values=orgcol) +
theme(legend.position="none", axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(x="", y="cells")
ggsave("scRNA-cells.pdf",gb1 + gb2, height=6.5, width=6)
scs <- fread("single-cell-studies.tsv")
scs <- as.data.table(tidyr::separate_rows(scs, "Organism", sep=", "))
scs <- scs[Organism != ""]
scs[, Organism:=stringr::str_replace_all(
Organism,
c(
"Arabidopsis thaliana" = "Arabidopsis",
"Caenorhabditis elegans"= "C.elegans",
"C elegans"= "C.elegans",
"Fruit fly" = "Drosophila"
)
)]
vrtb <- "Axolotl|bat|Bonobo|Branchiostoma|Chimpanzee|Chicken|Cow|Dog|Frog|Hamster|horse|lemur|Lizard|macaque|Rhesus|Marmoset|monkey|Pig|Rabbit|Stickleback|mole|cobra|snake|Salmon|Sheep|Hamster|Turtle|Xenopus|Pogona vitticeps"
scs[grep(vrtb, Organism, ignore.case = TRUE), Organism := "vertebrate"]
scs[Organism=="Schmidtea mediterranea"]
scs[Organism=="Planarian"]
scs <- fread("single-cell-studies.tsv")
scs <- as.data.table(tidyr::separate_rows(scs, "Organism", sep=", "))
scs <- scs[Organism != ""]
scs[, Organism:=stringr::str_replace_all(
Organism,
c(
"Arabidopsis thaliana" = "Arabidopsis",
"Caenorhabditis elegans"= "C.elegans",
"C elegans"= "C.elegans",
"Fruit fly" = "Drosophila",
"Planarian" = "Schmidtea mediterranea"
)
)]
vrtb <- "Axolotl|bat|Bonobo|Branchiostoma|Chimpanzee|Chicken|Cow|Dog|Frog|Hamster|horse|lemur|Lizard|macaque|Rhesus|Marmoset|monkey|Pig|Rabbit|Stickleback|mole|cobra|snake|Salmon|Sheep|Hamster|Turtle|Xenopus|Pogona vitticeps"
scs[grep(vrtb, Organism, ignore.case = TRUE), Organism := "vertebrate"]
sdt <- scs[,.N,Organism][order(N)]
dt <- sdt[,.(N=sum(N)),Organism][Organism!=""][order(-N)]
dta <- rbind.data.frame(dt[N>=10], data.table(Organism="other",N=sum(dt[N<10]$N)))
dta[,data:="scRNA"]
dta[,Organism:=factor(Organism,levels=c(setdiff(dta$Organism, c("vertebrate", "Arabidopsis", "other")), "vertebrate", "Arabidopsis", "other"))]
setorder(dta, Organism)
color_palette = colorRampPalette(c("magenta4","firebrick1","orange","khaki1","springgreen2","darkgreen","deepskyblue","cadetblue1","mediumblue","darkviolet","violet"))
color_blind  = colorRampPalette(c("#999999", "#CC79A7", "#D55E00", "#E69F00", "#F0E442","#009E73", "#56B4E9", "#0072B2"))
orgcol <- structure(rev(color_blind(nlevels(dta$Organism))), names=levels(dta$Organism))
gb1 <- ggplot(dta,aes(data,N,fill=Organism, label=Organism)) + geom_bar(stat="identity") +
#ggrepel::geom_label_repel(size=3, position=position_stack(vjust=0.5)) +
ggpubr::theme_pubclean() + scale_fill_manual(values=orgcol) +
theme(legend.position="left", axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(x="", y="datasets")
ggsave("scRNA-datasets.pdf",gb1,height=6.5,width=2)
sct <- scs[,.(Date,Organism,`Reported cells total`)]
scts <- as.data.table(tidyr::separate_rows(sct, "Organism", sep=", "))
scts[,total_cells:=as.integer(stringr::str_remove_all(`Reported cells total`,","))]
scts[,Date:=as.Date.character(Date,format="%Y%m%d")]
scts[,`Reported cells total`:= NULL]
scts <- scts[!is.na(total_cells)]
scts[, organism_cells := sum(total_cells), Organism]
orgcells <- unique(scts[ ,.(Organism, organism_cells)])[order(-organism_cells)]
scts[!Organism %in% dta$Organism, Organism := "other"]
scts[,Organism:=factor(Organism,levels=dta$Organism)]
setorder(scts, Organism)
scts[,organism_cells := sum(total_cells),Organism]
gp1 <- ggplot(scts,aes(Date, total_cells, color=Organism)) + geom_point() +
scale_y_log10(
breaks = scales::trans_breaks("log10", function(x) 10^x),
labels = scales::trans_format("log10", scales::math_format(10^.x))) +
scale_x_date(limits = c(as.Date.character("20120101",format="%Y%m%d"),NA)) +
ggpubr::theme_pubclean() + scale_color_manual(values = orgcol) +
theme(legend.position = "none") +
labs(y="Total reported cells per dataset",x="Year")
ggsave("scRNA-timeline-full.pdf",gp1,height=5,width=4.5)
dtb <- scts[,.(N=sum(total_cells,na.rm = TRUE)),Organism][,data:="cells"]
gb2 <- ggplot(dtb,aes(data,N,fill=Organism, label=Organism)) +
geom_bar(stat="identity") +
#ggrepel::geom_label_repel(size=3, position=position_stack(vjust=0.5)) +
ggpubr::theme_pubclean() +
scale_fill_manual(values=orgcol) +
theme(legend.position="none", axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(x="", y="cells")
ggsave("scRNA-cells.pdf",gb1 + gb2, height=6.5, width=6)
scts
celldt
sct <- scs[,.(Date,Organism,`Reported cells total`)]
scts <- as.data.table(tidyr::separate_rows(sct, "Organism", sep=", "))
scts[,total_cells:=as.integer(stringr::str_remove_all(`Reported cells total`,","))]
scts[,Date:=as.Date.character(Date,format="%Y%m%d")]
scts[,`Reported cells total`:= NULL]
scts <- scts[!is.na(total_cells)]
scts[, organism_cells := sum(total_cells), Organism]
scts
SCS[oRGANISM == "Ciona instestinalis"]
scs[Organism=="Ciona instestinalis"]
scs[Organism=="Ciona intestinalis"]
scs[Organism=="Stony coral"]
scs[grep("xenia", Organism, ignore.case=T)]
invs <- c(
"Ciona instestinalis", "Sea urchin", "Hydra", "Stony coral", "Schmidtea mediterranea", "Nematostella vectensis",
"Clytia hemisphaerica", "Ciona robusta", "Platynereis dumerilii"
)
invdt <- scts[Organism %in% invs]
invdt
gb2
dtb <- invdt[,.(N=sum(total_cells,na.rm = TRUE)),Organism][,data:="cells"]
dtb
dtb
setorder(dtb, -N)
dtb[, Organism := factor(Organism, levels = dtb$Organism)]
dtb
dtb
gb4 <- ggplot(dtb,aes(data,N,fill=Organism, label=Organism)) +
geom_bar(stat="identity") +
#ggrepel::geom_label_repel(size=3, position=position_stack(vjust=0.5)) +
ggpubr::theme_pubclean() +
#scale_fill_manual(values=invcol) +
theme(legend.position="none", axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(x="", y="cells")
ggsave("scRNA-cells-inv.pdf", gb4, height=6.5, width=5)
gb4 <- ggplot(dtb,aes(data,N,fill=Organism, label=Organism)) +
geom_bar(stat="identity") +
#ggrepel::geom_label_repel(size=3, position=position_stack(vjust=0.5)) +
ggpubr::theme_pubclean() +
#scale_fill_manual(values=invcol) +
theme(legend.position="left", axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(x="", y="cells")
ggsave("scRNA-cells-inv.pdf", gb4, height=6.5, width=5)
dtb
scts[Organism=="Nematostella vectensis"]
scs[Organism=="Nematostella vectensis"]
invdt
invdt <- rbindlist(list(
scts[Organism %in% invs],
data.table(
Organism = "Nematostella vectensis",
total_cells = 55042
)
), fill=TRUE)
invdt
dtb <- invdt[,.(N=sum(total_cells,na.rm = TRUE)),Organism][,data:="cells"]
setorder(dtb, -N)
dtb[, Organism := factor(Organism, levels = dtb$Organism)]
gb4 <- ggplot(dtb,aes(data,N,fill=Organism, label=Organism)) +
geom_bar(stat="identity") +
#ggrepel::geom_label_repel(size=3, position=position_stack(vjust=0.5)) +
ggpubr::theme_pubclean() +
#scale_fill_manual(values=invcol) +
theme(legend.position="left", axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(x="", y="cells")
ggsave("scRNA-cells-inv.pdf", gb4, height=6.5, width=5)
invdt <- rbindlist(list(
scts[Organism %in% invs],
data.table(
Organism = "Nematostella vectensis",
total_cells = 55042
),
data.table(
Organism = "Xenia",
total_cells = 25271
),
data.table(
Organism = "Trichoplax adherens",
total_cells = 3731
),
data.table(
Organism = "Mnemiopsis leidyi",
total_cells = 5587
),
data.table(
Organism = "Schistosoma mansoni",
total_cells = 43642
)
), fill=TRUE)
dtb <- invdt[,.(N=sum(total_cells,na.rm = TRUE)),Organism][,data:="cells"]
setorder(dtb, -N)
dtb[, Organism := factor(Organism, levels = dtb$Organism)]
color_palette
invdt
unique(invdt$Organism)
length(unique(invdt$Organism))
dtb <- invdt[,.(N=sum(total_cells,na.rm = TRUE)),Organism][,data:="cells"]
setorder(dtb, -N)
dtb[, Organism := factor(Organism, levels = dtb$Organism)]
invcol <- structure(
color_palette(nlevels(dtb$Organism)),
names = levels(dtb$Organism)
)
invcol
gb4 <- ggplot(dtb,aes(data,N,fill=Organism, label=Organism)) +
geom_bar(stat="identity") +
#ggrepel::geom_label_repel(size=3, position=position_stack(vjust=0.5)) +
ggpubr::theme_pubclean() +
scale_fill_manual(values=invcol) +
theme(legend.position="left", axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(x="", y="cells")
ggsave("scRNA-cells-inv.pdf", gb4, height=6.5, width=5)
library(data.table)
library(ggplot2)
library(patchwork)
setwd("~/cluster/aelek/presentations/BCA230515/")
# scs <- fread("https://www.nxn.se/single-cell-studies/data.tsv")
# fwrite(scs,"single-cell-studies.tsv",sep="\t",col.names=TRUE)
scs <- fread("single-cell-studies.tsv")
scs <- as.data.table(tidyr::separate_rows(scs, "Organism", sep=", "))
scs <- scs[Organism != ""]
scs[, Organism:=stringr::str_replace_all(
Organism,
c(
"Arabidopsis thaliana" = "Arabidopsis",
"Caenorhabditis elegans"= "C.elegans",
"C elegans"= "C.elegans",
"Fruit fly" = "Drosophila",
"Planarian" = "Schmidtea mediterranea",
"Ciona intestinalis" = "Ciona instestinalis",
"Ciona" = "Ciona instestinalis",
"Stony coral" = "Stylophora pistillata"
)
)]
vrtb <- "Axolotl|bat|Bonobo|Branchiostoma|Chimpanzee|Chicken|Cow|Dog|Frog|Hamster|horse|lemur|Lizard|macaque|Rhesus|Marmoset|monkey|Pig|Rabbit|Stickleback|mole|cobra|snake|Salmon|Sheep|Hamster|Turtle|Xenopus|Pogona vitticeps"
scs[grep(vrtb, Organism, ignore.case = TRUE), Organism := "vertebrate"]
sdt <- scs[,.N,Organism][order(N)]
dt <- sdt[,.(N=sum(N)),Organism][Organism!=""][order(-N)]
dta <- rbind.data.frame(dt[N>=10], data.table(Organism="other",N=sum(dt[N<10]$N)))
dta[,data:="scRNA"]
dta[,Organism:=factor(Organism,levels=c(setdiff(dta$Organism, c("vertebrate", "Arabidopsis", "other")), "vertebrate", "Arabidopsis", "other"))]
setorder(dta, Organism)
color_palette = colorRampPalette(c("magenta4","firebrick1","orange","khaki1","springgreen2","darkgreen","deepskyblue","cadetblue1","mediumblue","darkviolet","violet"))
color_blind  = colorRampPalette(c("#999999", "#CC79A7", "#D55E00", "#E69F00", "#F0E442","#009E73", "#56B4E9", "#0072B2"))
orgcol <- structure(rev(color_blind(nlevels(dta$Organism))), names=levels(dta$Organism))
gb1 <- ggplot(dta,aes(data,N,fill=Organism, label=Organism)) + geom_bar(stat="identity") +
#ggrepel::geom_label_repel(size=3, position=position_stack(vjust=0.5)) +
ggpubr::theme_pubclean() + scale_fill_manual(values=orgcol) +
theme(legend.position="left", axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(x="", y="datasets")
ggsave("scRNA-datasets.pdf",gb1,height=6.5,width=2)
sct <- scs[,.(Date,Organism,`Reported cells total`)]
scts <- as.data.table(tidyr::separate_rows(sct, "Organism", sep=", "))
scts[,total_cells:=as.integer(stringr::str_remove_all(`Reported cells total`,","))]
scts[,Date:=as.Date.character(Date,format="%Y%m%d")]
scts[,`Reported cells total`:= NULL]
scts <- scts[!is.na(total_cells)]
scts[, organism_cells := sum(total_cells), Organism]
celldt <- copy(scts)
celldt[!Organism %in% dta$Organism, Organism := "other"]
celldt[,Organism:=factor(Organism,levels=dta$Organism)]
setorder(celldt, Organism)
celldt[,organism_cells := sum(total_cells),Organism]
gp1 <- ggplot(celldt,aes(Date, total_cells, color=Organism)) + geom_point() +
scale_y_log10(
breaks = scales::trans_breaks("log10", function(x) 10^x),
labels = scales::trans_format("log10", scales::math_format(10^.x))) +
scale_x_date(limits = c(as.Date.character("20120101",format="%Y%m%d"),NA)) +
ggpubr::theme_pubclean() + scale_color_manual(values = orgcol) +
theme(legend.position = "none") +
labs(y="Total reported cells per dataset",x="Year")
dtb <- scts[,.(N=sum(total_cells,na.rm = TRUE)),Organism][,data:="cells"]
gb2 <- ggplot(dtb,aes(data,N,fill=Organism, label=Organism)) +
geom_bar(stat="identity") +
#ggrepel::geom_label_repel(size=3, position=position_stack(vjust=0.5)) +
ggpubr::theme_pubclean() +
scale_fill_manual(values=orgcol) +
theme(legend.position="none", axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(x="", y="cells")
ggsave("scRNA-cells.pdf",gb1 + gb2, height=6.5, width=6)
invs <- c(
"Ciona instestinalis", "Sea urchin", "Hydra", "Stylophora pistillata", "Schmidtea mediterranea", "Nematostella vectensis",
"Clytia hemisphaerica", "Ciona robusta", "Platynereis dumerilii"
)
invdt <- rbindlist(list(
scts[Organism %in% invs],
data.table(
Organism = "Nematostella vectensis",
total_cells = 55042
),
data.table(
Organism = "Xenia",
total_cells = 25271
),
data.table(
Organism = "Trichoplax adherens",
total_cells = 3731
),
data.table(
Organism = "Mnemiopsis leidyi",
total_cells = 5587
),
data.table(
Organism = "Schistosoma mansoni",
total_cells = 43642
)
), fill=TRUE)
dtb <- invdt[,.(N=sum(total_cells,na.rm = TRUE)),Organism][,data:="cells"]
setorder(dtb, -N)
dtb[, Organism := factor(Organism, levels = dtb$Organism)]
invcol <- structure(
color_palette(nlevels(dtb$Organism)),
names = levels(dtb$Organism)
)
gb4 <- ggplot(dtb,aes(data,N,fill=Organism, label=Organism)) +
geom_bar(stat="identity") +
#ggrepel::geom_label_repel(size=3, position=position_stack(vjust=0.5)) +
ggpubr::theme_pubclean() +
scale_fill_manual(values=invcol) +
theme(legend.position="left", axis.ticks.x = element_blank(), axis.text.x = element_blank()) +
labs(x="", y="cells")
ggsave("scRNA-cells-inv.pdf", gb4, height=6.5, width=5)
shiny::runApp('cluster/aelek/proj/shiny_amphi_development')
runApp('cluster/aelek/proj/shiny_amphi_development')
runApp('cluster/aelek/proj/shiny_amphi_development')
devtools::install_github(repo="sebepedroslab/shinyscdb", auth_token="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", force=TRUE)
runApp('cluster/aelek/proj/shiny_amphi_development')
library(shinyscdb)
runApp('cluster/aelek/proj/shiny_amphi_development')
??atlasIntroUI
library(shinyscdb)
runApp('cluster/aelek/proj/shiny_amphi_development')
shiny::runApp('cluster/aelek/proj/shiny_amphi_development')
runApp('cluster/aelek/proj/shiny_amphi_development')
runApp('cluster/aelek/proj/shiny_amphi_development')
setwd("~/cluster/aelek/proj/nvec_neural/")
